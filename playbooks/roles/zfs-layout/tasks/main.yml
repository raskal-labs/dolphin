---
# Blathers: manage ZFS datasets and mountpoints for the homelab layout.

- name: Ensure ZFS datasets exist
  community.general.zfs:
    name: "{{ item.name }}"
    state: present
  loop: "{{ blathers_zfs_datasets }}"

- name: Ensure ZFS mountpoints are set on top-level datasets
  ansible.builtin.command: >
    zfs set mountpoint={{ blathers_zfs_mountpoints[item] }} {{ item }}
  loop: "{{ blathers_zfs_mountpoints.keys() | list }}"
  changed_when: false

