---
# playbooks/link-cable-full.yml
- name: Provision link-cable LXC on gamecube
  hosts: gamecube
  gather_facts: false
  roles:
    - pve-lxc
    - ssh-base    # SSH hardening on gamecube

- name: Update and baseline Debian inside link-cable
  hosts: link-cable
  gather_facts: false  # Wait for SSH before gathering facts

  pre_tasks:
    - name: Wait for SSH to be ready on link-cable
      wait_for_connection:
        timeout: 60
        delay: 5
        sleep: 3

    - name: Gather facts after SSH is up
      setup:

  roles:
    - base-debian
    - ssh-base    # key-only SSH inside CT
    - lxc-adguard
